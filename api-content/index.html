{"posts":[{"title":"Webpacké…ç½®è¯¦è§£","content":"Webpacké…ç½® webpack æ˜¯éœ€è¦ä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡(configuration object)ã€‚å–å†³äºä½ å¦‚ä½•ä½¿ç”¨ webpackï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼šç»ˆç«¯æˆ– Node.jsã€‚ä¸‹é¢æŒ‡å®šäº†æ‰€æœ‰å¯ç”¨çš„é…ç½®é€‰é¡¹ã€‚ æ³¨æ„æ•´ä¸ªé…ç½®ä¸­æˆ‘ä»¬ä½¿ç”¨ Node å†…ç½®çš„ path æ¨¡å—ï¼Œå¹¶åœ¨å®ƒå‰é¢åŠ ä¸Š __dirnameè¿™ä¸ªå…¨å±€å˜é‡ã€‚å¯ä»¥é˜²æ­¢ä¸åŒæ“ä½œç³»ç»Ÿä¹‹é—´çš„æ–‡ä»¶è·¯å¾„é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç›¸å¯¹è·¯å¾„æŒ‰ç…§é¢„æœŸå·¥ä½œã€‚ é€‰é¡¹æ¦‚è¿° Web pack.config.js const path = require('path'); module.exports = { // é€‰æ‹©æ¨¡å¼å‘Šè¯‰ Webpack ç›¸åº”åœ°ä½¿ç”¨å…¶å†…ç½®çš„ä¼˜åŒ–ã€‚ mode: &quot;production&quot;, // &quot;production&quot; | &quot;development&quot; | &quot;none&quot; // è¿™é‡Œåº”ç”¨ç¨‹åºå¼€å§‹æ‰§è¡Œ webpack å¼€å§‹æ‰“åŒ… entry: &quot;./app/entry&quot;, // string | object | array output: { // webpack å¦‚ä½•è¾“å‡ºç»“æœçš„ç›¸å…³é€‰é¡¹ path: path.resolve(__dirname, &quot;dist&quot;), // string // æ‰€æœ‰è¾“å‡ºæ–‡ä»¶çš„ç›®æ ‡è·¯å¾„ // å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ï¼ˆä½¿ç”¨ Node.js çš„ path æ¨¡å—ï¼‰ filename: &quot;bundle.js&quot;, // string // ã€Œå…¥å£åˆ†å—(entry chunk)ã€çš„æ–‡ä»¶åæ¨¡æ¿ï¼ˆå‡ºå£åˆ†å—ï¼Ÿï¼‰ publicPath: &quot;/assets/&quot;, // string // è¾“å‡ºè§£ææ–‡ä»¶çš„ç›®å½•ï¼Œurl ç›¸å¯¹äº HTML é¡µé¢ library: &quot;MyLibrary&quot;, // string, // å¯¼å‡ºåº“(exported library)çš„åç§° libraryTarget: &quot;umd&quot;, // é€šç”¨æ¨¡å—å®šä¹‰ // å¯¼å‡ºåº“(exported library)çš„ç±»å‹ module: { // å…³äºæ¨¡å—é…ç½® rules: [ // æ¨¡å—è§„åˆ™ï¼ˆé…ç½® loaderã€è§£æå™¨ç­‰é€‰é¡¹ï¼‰ { test: /\\.jsx?$/, include: [ path.resolve(__dirname, &quot;app&quot;) ], exclude: [ path.resolve(__dirname, &quot;app/demo-files&quot;) ], // è¿™é‡Œæ˜¯åŒ¹é…æ¡ä»¶ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½æ¥æ”¶ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æˆ–å­—ç¬¦ä¸² // test å’Œ include å…·æœ‰ç›¸åŒçš„ä½œç”¨ï¼Œéƒ½æ˜¯å¿…é¡»åŒ¹é…é€‰é¡¹ // exclude æ˜¯å¿…ä¸åŒ¹é…é€‰é¡¹ï¼ˆä¼˜å…ˆäº test å’Œ includeï¼‰ // æœ€ä½³å®è·µï¼š // - åªåœ¨ test å’Œ æ–‡ä»¶ååŒ¹é… ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ // - åœ¨ include å’Œ exclude ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„æ•°ç»„ // - å°½é‡é¿å… excludeï¼Œæ›´å€¾å‘äºä½¿ç”¨ include issuer: { test, include, exclude }, // issuer æ¡ä»¶ï¼ˆå¯¼å…¥æºï¼‰ enforce: &quot;pre&quot;, enforce: &quot;post&quot;, // æ ‡è¯†åº”ç”¨è¿™äº›è§„åˆ™ï¼Œå³ä½¿è§„åˆ™è¦†ç›–ï¼ˆé«˜çº§é€‰é¡¹ï¼‰ loader: &quot;babel-loader&quot;, // åº”è¯¥åº”ç”¨çš„ loaderï¼Œå®ƒç›¸å¯¹ä¸Šä¸‹æ–‡è§£æ // ä¸ºäº†æ›´æ¸…æ™°ï¼Œ`-loader` åç¼€åœ¨ webpack 2 ä¸­ä¸å†æ˜¯å¯é€‰çš„ // æŸ¥çœ‹ webpack 1 å‡çº§æŒ‡å—ã€‚ options: { presets: [&quot;es2015&quot;] }, // loader çš„å¯é€‰é¡¹ }, { test: /\\.html$/, test: &quot;\\.html$&quot; use: [ // åº”ç”¨å¤šä¸ª loader å’Œé€‰é¡¹ &quot;htmllint-loader&quot;, { loader: &quot;html-loader&quot;, options: { /* ... */ } } ] }, { oneOf: [ /* rules */ ] }, // åªä½¿ç”¨è¿™äº›åµŒå¥—è§„åˆ™ä¹‹ä¸€ { rules: [ /* rules */ ] }, // ä½¿ç”¨æ‰€æœ‰è¿™äº›åµŒå¥—è§„åˆ™ï¼ˆåˆå¹¶å¯ç”¨æ¡ä»¶ï¼‰ { resource: { and: [ /* æ¡ä»¶ */ ] } }, // ä»…å½“æ‰€æœ‰æ¡ä»¶éƒ½åŒ¹é…æ—¶æ‰åŒ¹é… { resource: { or: [ /* æ¡ä»¶ */ ] } }, { resource: [ /* æ¡ä»¶ */ ] }, // ä»»æ„æ¡ä»¶åŒ¹é…æ—¶åŒ¹é…ï¼ˆé»˜è®¤ä¸ºæ•°ç»„ï¼‰ { resource: { not: /* æ¡ä»¶ */ } } // æ¡ä»¶ä¸åŒ¹é…æ—¶åŒ¹é… ], /* é«˜çº§æ¨¡å—é…ç½®ï¼ˆç‚¹å‡»å±•ç¤ºï¼‰ */ }, resolve: { // è§£ææ¨¡å—è¯·æ±‚çš„é€‰é¡¹ // ï¼ˆä¸é€‚ç”¨äºå¯¹ loader è§£æï¼‰ modules: [ &quot;node_modules&quot;, path.resolve(__dirname, &quot;app&quot;) ], // ç”¨äºæŸ¥æ‰¾æ¨¡å—çš„ç›®å½• extensions: [&quot;.js&quot;, &quot;.json&quot;, &quot;.jsx&quot;, &quot;.css&quot;], // ä½¿ç”¨çš„æ‰©å±•å alias: { // æ¨¡å—åˆ«ååˆ—è¡¨ &quot;module&quot;: path.resolve(__dirname, &quot;app/third/module.js&quot;), // èµ·åˆ«å &quot;module&quot; -&gt; &quot;./app/third/module.js&quot; å’Œ &quot;module/file&quot; ä¼šå¯¼è‡´é”™è¯¯ // æ¨¡å—åˆ«åç›¸å¯¹äºå½“å‰ä¸Šä¸‹æ–‡å¯¼å…¥ }, performance: { hints: &quot;warning&quot;, // æšä¸¾ maxAssetSize: 200000, // æ•´æ•°ç±»å‹ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ maxEntrypointSize: 400000, // æ•´æ•°ç±»å‹ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ assetFilter: function(assetFilename) { // æä¾›èµ„æºæ–‡ä»¶åçš„æ–­è¨€å‡½æ•° return assetFilename.endsWith('.css') || assetFilename.endsWith('.js'); } }, devtool: &quot;source-map&quot;, // enum // é€šè¿‡åœ¨æµè§ˆå™¨è°ƒè¯•å·¥å…·(browser devtools)ä¸­æ·»åŠ å…ƒä¿¡æ¯(meta info)å¢å¼ºè°ƒè¯• // ç‰ºç‰²äº†æ„å»ºé€Ÿåº¦çš„ `source-map' æ˜¯æœ€è¯¦ç»†çš„ã€‚ context: __dirname, // stringï¼ˆç»å¯¹è·¯å¾„ï¼ï¼‰ // webpack çš„ä¸»ç›®å½• // entry å’Œ module.rules.loader é€‰é¡¹ // ç›¸å¯¹äºæ­¤ç›®å½•è§£æ target: &quot;web&quot;, // æšä¸¾ // åŒ…(bundle)åº”è¯¥è¿è¡Œçš„ç¯å¢ƒ // æ›´æ”¹ å—åŠ è½½è¡Œä¸º(chunk loading behavior) å’Œ å¯ç”¨æ¨¡å—(available module) externals: [&quot;react&quot;, /^@angular\\//], // ä¸è¦éµå¾ª/æ‰“åŒ…è¿™äº›æ¨¡å—ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶ä»ç¯å¢ƒä¸­è¯·æ±‚ä»–ä»¬ stats: &quot;errors-only&quot;, // ç²¾ç¡®æ§åˆ¶è¦æ˜¾ç¤ºçš„ bundle ä¿¡æ¯ devServer: { proxy: { // ä»£ç† URL åˆ°åç«¯å¼€å‘æœåŠ¡å™¨ '/api': 'http://localhost:3000' }, contentBase: path.join(__dirname, 'public'), // boolean | string | array, static file location compress: true, // å¯ç”¨ gzip å‹ç¼© historyApiFallback: true, // 404 æ—¶ç´¢å¼•. html ä¸º trueï¼Œå¤šä¸ªè·¯å¾„çš„å¯¹è±¡ä¸º true hot: true, // çƒ­æ¨¡å—æ›¿æ¢ã€‚å–å†³äºçƒ­æ¨¡å—æ›¿æ¢æ’ä»¶ https: false, // ä¸ºtrue è¯ä¹¦é¢å‘çš„å¯¹è±¡ noInfo: true, // ä»…é”™è¯¯ çƒ­é‡æ–°åŠ è½½æ—¶è­¦å‘Š // ... }, plugins: [ // æ’ä»¶ ], // é™„åŠ æ’ä»¶åˆ—è¡¨ } å¤šç§é…ç½®ç±»å‹ é™¤äº†å¯¼å‡ºå•ä¸ªé…ç½®å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€äº›æ–¹å¼æ»¡è¶³å…¶ä»–éœ€æ±‚ã€‚ å¯¼å‡ºä¸ºä¸€ä¸ªå‡½æ•° æœ€ç»ˆï¼Œä½ ä¼šå‘ç°éœ€è¦åœ¨å¼€å‘å’Œç”Ÿäº§æ„å»ºä¹‹é—´ï¼Œæ¶ˆé™¤ webpack.config.js çš„å·®å¼‚ã€‚ï¼ˆè‡³å°‘ï¼‰æœ‰ä¸¤ç§é€‰é¡¹ï¼š ä½œä¸ºå¯¼å‡ºä¸€ä¸ªé…ç½®å¯¹è±¡çš„æ›¿ä»£ï¼Œè¿˜æœ‰ä¸€ç§å¯é€‰çš„å¯¼å‡ºæ–¹å¼æ˜¯ï¼Œä» webpack é…ç½®æ–‡ä»¶ä¸­å¯¼å‡ºä¸€ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œå¯ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š â€‹ ç¯å¢ƒå¯¹è±¡(environment)ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¸€ä¸ªé€‰é¡¹ map å¯¹è±¡ï¼ˆargvï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™ä¸ªå¯¹è±¡æè¿°äº†ä¼ é€’ç»™ webpack çš„é€‰é¡¹ï¼Œå¹¶ä¸”å…·æœ‰ output-filename å’Œ optimize-minimize ç­‰ keyã€‚ module.exports = function(env, argv) { return { mode: env.production ? 'production' : 'development', devtool: env.production ? 'source-maps' : 'eval', plugins: [ new webpack.optimize.UglifyJsPlugin({ compress: argv['optimize-minimize'] // åªæœ‰ä¼ å…¥ -p æˆ– --optimize-minimize }) ] }; }; å¯¼å‡ºä¸€ä¸ªPromise webpack å°†è¿è¡Œç”±é…ç½®æ–‡ä»¶å¯¼å‡ºçš„å‡½æ•°ï¼Œå¹¶ä¸”ç­‰å¾… Promise è¿”å›ã€‚ä¾¿äºéœ€è¦å¼‚æ­¥åœ°åŠ è½½æ‰€éœ€çš„é…ç½®å˜é‡ã€‚ module.exports = () =&gt; { return new Promise((resolve, reject) =&gt; { setTimeout(() =&gt; { resolve({ entry: './app.js', /* ... */ }) }, 5000) }) } å¯¼å‡ºå¤šä¸ªé…ç½®å¯¹è±¡ ä½œä¸ºå¯¼å‡ºä¸€ä¸ªé…ç½®å¯¹è±¡/é…ç½®å‡½æ•°çš„æ›¿ä»£ï¼Œä½ å¯èƒ½éœ€è¦å¯¼å‡ºå¤šä¸ªé…ç½®å¯¹è±¡ï¼ˆä» webpack 3.1.0 å¼€å§‹æ”¯æŒå¯¼å‡ºå¤šä¸ªå‡½æ•°ï¼‰ã€‚å½“è¿è¡Œ webpack æ—¶ï¼Œæ‰€æœ‰çš„é…ç½®å¯¹è±¡éƒ½ä¼šæ„å»ºã€‚ä¾‹å¦‚ï¼Œå¯¼å‡ºå¤šä¸ªé…ç½®å¯¹è±¡ï¼Œå¯¹äºé’ˆå¯¹å¤šä¸ªæ„å»ºç›®æ ‡ï¼ˆä¾‹å¦‚ AMD å’Œ CommonJSï¼‰æ‰“åŒ…ä¸€ä¸ª library éå¸¸æœ‰ç”¨ã€‚ module.exports = [{ output: { filename: './dist-amd.js', libraryTarget: 'amd' }, entry: './app.js', mode: 'production', }, { output: { filename: './dist-commonjs.js', libraryTarget: 'commonjs' }, entry: './app.js', mode: 'production', }] å…¥å£å’Œä¸Šä¸‹æ–‡ string entry å¯¹è±¡æ˜¯ç”¨äº webpack æŸ¥æ‰¾å¯åŠ¨å¹¶æ„å»º bundleã€‚å…¶ä¸Šä¸‹æ–‡æ˜¯å…¥å£æ–‡ä»¶æ‰€å¤„çš„ç›®å½•çš„ç»å¯¹è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚ context åŸºç¡€ç›®å½•ï¼Œç»å¯¹è·¯å¾„ï¼Œç”¨äºä»é…ç½®ä¸­è§£æå…¥å£èµ·ç‚¹(entry point)å’Œ loader context: path.resolve(__dirname, &quot;app&quot;) é»˜è®¤ä½¿ç”¨å½“å‰ç›®å½•ï¼Œä½†æ˜¯æ¨èåœ¨é…ç½®ä¸­ä¼ é€’ä¸€ä¸ªå€¼ã€‚è¿™ä½¿å¾—ä½ çš„é…ç½®ç‹¬ç«‹äº CWD(current working directory - å½“å‰æ‰§è¡Œè·¯å¾„)ã€‚ å¹³æ—¶ç”¨ä¸åˆ° entry string | [string] | object { &lt;key&gt;: string | [string] } | (function: () =&gt; string | [string] | object { &lt;key&gt;: string | [string] }) èµ·ç‚¹æˆ–æ˜¯åº”ç”¨ç¨‹åºçš„èµ·ç‚¹å…¥å£ã€‚ä»è¿™ä¸ªèµ·ç‚¹å¼€å§‹ï¼Œåº”ç”¨ç¨‹åºå¯åŠ¨æ‰§è¡Œã€‚å¦‚æœä¼ é€’ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆæ•°ç»„çš„æ¯ä¸€é¡¹éƒ½ä¼šæ‰§è¡Œã€‚ åŠ¨æ€åŠ è½½çš„æ¨¡å—ä¸æ˜¯å…¥å£èµ·ç‚¹ã€‚ ç®€å•è§„åˆ™ï¼šæ¯ä¸ª HTML é¡µé¢éƒ½æœ‰ä¸€ä¸ªå…¥å£èµ·ç‚¹ã€‚å•é¡µåº”ç”¨(SPA)ï¼šä¸€ä¸ªå…¥å£èµ·ç‚¹ï¼Œå¤šé¡µåº”ç”¨(MPA)ï¼šå¤šä¸ªå…¥å£èµ·ç‚¹ã€‚ entry: { home: &quot;./home.js&quot;, about: &quot;./about.js&quot;, contact: &quot;./contact.js&quot; } å‘½å å¦‚æœä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ï¼Œchunk ä¼šè¢«å‘½åä¸º mainã€‚å¦‚æœä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ¯ä¸ªé”®(key)ä¼šæ˜¯ chunk çš„åç§°ï¼Œè¯¥å€¼æè¿°äº† chunk çš„å…¥å£èµ·ç‚¹ã€‚ åŠ¨æ€å…¥å£ entry: () =&gt; './demo' æˆ– entry: () =&gt; new Promise((resolve) =&gt; resolve(['./demo', './demo2'])) å½“ç»“åˆ output.library é€‰é¡¹æ—¶ï¼šå¦‚æœä¼ å…¥æ•°ç»„ï¼Œåˆ™åªå¯¼å‡ºæœ€åä¸€é¡¹ã€‚ è¾“å‡º output ä½äºå¯¹è±¡æœ€é¡¶çº§é”®(key)ï¼ŒåŒ…æ‹¬äº†ä¸€ç»„é€‰é¡¹ï¼ŒæŒ‡ç¤º webpack å¦‚ä½•å»è¾“å‡ºã€ä»¥åŠåœ¨å“ªé‡Œè¾“å‡ºä½ çš„ ã€Œbundleã€asset å’Œå…¶ä»–ä½ æ‰€æ‰“åŒ…æˆ–ä½¿ç”¨ webpack è½½å…¥çš„ä»»ä½•å†…å®¹ã€ã€‚ output.filename string function æ­¤é€‰é¡¹å†³å®šäº†æ¯ä¸ªè¾“å‡º bundle çš„åç§°ã€‚è¿™äº› bundle å°†å†™å…¥åˆ° output.path é€‰é¡¹æŒ‡å®šçš„ç›®å½•ä¸‹ã€‚ å¯¹äºå•ä¸ªå…¥å£èµ·ç‚¹ï¼Œfilename ä¼šæ˜¯ä¸€ä¸ªé™æ€åç§°ã€‚ filename: &quot;bundle.js&quot; ç„¶è€Œï¼Œå½“é€šè¿‡å¤šä¸ªå…¥å£èµ·ç‚¹(entry point)ã€ä»£ç æ‹†åˆ†(code splitting)æˆ–å„ç§æ’ä»¶(plugin)åˆ›å»ºå¤šä¸ª bundleï¼Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹ä¸€ç§æ›¿æ¢æ–¹å¼ï¼Œæ¥èµ‹äºˆæ¯ä¸ª bundle ä¸€ä¸ªå”¯ä¸€çš„åç§°â€¦â€¦ ä½¿ç”¨å…¥å£åç§°ï¼š filename: &quot;[name].bundle.js&quot; ä½¿ç”¨å†…éƒ¨ chunk id filename: &quot;[id].bundle.js&quot; ä½¿ç”¨æ¯æ¬¡æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå”¯ä¸€çš„ hash ç”Ÿæˆ filename: &quot;[name].[hash].bundle.js&quot; ä½¿ç”¨åŸºäºæ¯ä¸ª chunk å†…å®¹çš„ hashï¼š filename: &quot;[chunkhash].bundle.js&quot; æ³¨æ„æ­¤é€‰é¡¹è¢«ç§°ä¸ºæ–‡ä»¶åï¼Œä½†æ˜¯ä½ è¿˜æ˜¯å¯ä»¥ä½¿ç”¨åƒ &quot;js/[name]/bundle.js&quot; è¿™æ ·çš„æ–‡ä»¶å¤¹ç»“æ„ã€‚ æ³¨æ„ï¼Œæ­¤é€‰é¡¹ä¸ä¼šå½±å“é‚£äº›ã€ŒæŒ‰éœ€åŠ è½½ chunkã€çš„è¾“å‡ºæ–‡ä»¶ã€‚å¯¹äºè¿™äº›æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ output.chunkFilename é€‰é¡¹æ¥æ§åˆ¶è¾“å‡ºã€‚é€šè¿‡ loader åˆ›å»ºçš„æ–‡ä»¶ä¹Ÿä¸å—å½±å“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»å°è¯• loader ç‰¹å®šçš„å¯ç”¨é€‰é¡¹ã€‚ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ›¿æ¢æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆé€šè¿‡ webpack å†…éƒ¨çš„[TemplatedPathPlugin]TemplatedPathPluginï¼‰ï¼š æ¨¡æ¿ æè¿° [hash] æ¨¡å—æ ‡è¯†ç¬¦çš„hash [chunkhash] chunkå†…å®¹çš„hash [name] æ¨¡å—åç§° [id] æ¨¡å—æ ‡è¯†ç¬¦ [query] æ¨¡å—çš„query,ä¾‹å¦‚,æ–‡ä»¶å?åé¢çš„å­—ç¬¦ä¸² [hash] å’Œ [chunkhash] çš„é•¿åº¦å¯ä»¥ä½¿ç”¨ [hash:16]ï¼ˆé»˜è®¤ä¸º20ï¼‰æ¥æŒ‡å®šã€‚æˆ–è€…ï¼Œé€šè¿‡æŒ‡å®šoutput.hashDigestLength åœ¨å…¨å±€é…ç½®é•¿åº¦ã€‚ output.path string outputç›®å½•å¯¹åº”ä¸€ä¸ªç»å¯¹è·¯å¾„ path:path.reslove(__dirname,'dist/assets') æ³¨æ„ï¼Œ[hash] åœ¨å‚æ•°ä¸­è¢«æ›¿æ¢ä¸ºç¼–è¯‘è¿‡ç¨‹(compilation)çš„ hashã€‚ output.publicPath string function å¯¹äºæŒ‰éœ€åŠ è½½(on-demand-load)æˆ–åŠ è½½å¤–éƒ¨èµ„æº(external resources)ï¼ˆå¦‚å›¾ç‰‡ã€æ–‡ä»¶ç­‰ï¼‰æ¥è¯´ï¼Œoutput.publicPath æ˜¯å¾ˆé‡è¦çš„é€‰é¡¹ã€‚å¦‚æœæŒ‡å®šäº†ä¸€ä¸ªé”™è¯¯çš„å€¼ï¼Œåˆ™åœ¨åŠ è½½è¿™äº›èµ„æºæ—¶ä¼šæ”¶åˆ° 404 é”™è¯¯ã€‚ æ­¤é€‰é¡¹æŒ‡å®šåœ¨æµè§ˆå™¨ä¸­æ‰€å¼•ç”¨çš„ã€Œæ­¤è¾“å‡ºç›®å½•å¯¹åº”çš„å…¬å¼€ URLã€ã€‚ç›¸å¯¹ URL(relative URL) ä¼šè¢«ç›¸å¯¹äº HTML é¡µé¢ï¼ˆæˆ– `` æ ‡ç­¾ï¼‰è§£æã€‚ç›¸å¯¹äºæœåŠ¡çš„ URL(Server-relative URL)ï¼Œç›¸å¯¹äºåè®®çš„ URL(protocol-relative URL) æˆ–ç»å¯¹ URL(absolute URL) ä¹Ÿå¯æ˜¯å¯èƒ½ç”¨åˆ°çš„ï¼Œæˆ–è€…æœ‰æ—¶å¿…é¡»ç”¨åˆ°ï¼Œä¾‹å¦‚ï¼šå½“å°†èµ„æºæ‰˜ç®¡åˆ° CDN æ—¶ã€‚ è¯¥é€‰é¡¹çš„å€¼æ˜¯ä»¥ runtime(è¿è¡Œæ—¶) æˆ– loader(è½½å…¥æ—¶) æ‰€åˆ›å»ºçš„æ¯ä¸ª URL ä¸ºå‰ç¼€ã€‚å› æ­¤ï¼Œåœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæ­¤é€‰é¡¹çš„å€¼éƒ½ä¼šä»¥/ç»“æŸã€‚ é»˜è®¤å€¼æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸² &quot;&quot;ã€‚ ç®€å•è§„åˆ™å¦‚ä¸‹ï¼šoutput.path ä¸­çš„ URL ä»¥ HTML é¡µé¢ä¸ºåŸºå‡†ã€‚ path: path.resolve(__dirname, &quot;public/assets&quot;), publicPath: &quot;https://cdn.example.com/assets/&quot; Optimization ç”±äºç‰ˆæœ¬ 4 Webpack ä¼šæ ¹æ®æ‰€é€‰æ¨¡å¼è¿è¡Œä¼˜åŒ–ï¼Œå› æ­¤æ‰€æœ‰ä¼˜åŒ–ä»å¯ç”¨äºæ‰‹åŠ¨é…ç½®å’Œè¦†ç›–ã€‚ optimization.minimize boolean = true å‘Šè¯‰ Webpack ä½¿ç”¨ TerserPlugin æˆ–ä¼˜åŒ–ä¸­æŒ‡å®šçš„æ’ä»¶æœ€å°åŒ–æ†ç»‘åŒ…ã€‚ Webpack.config.js module.exports = { //... optimization: { minimize: false } }; optimization.minimizer [TerserPlugin]æˆ–è€…[function (compiler)] å…è®¸æ‚¨é€šè¿‡æä¾›ä¸åŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå®šä¹‰ TerserPlugin å®ä¾‹æ¥è¦†ç›–é»˜è®¤æœ€å°åŒ–å™¨ã€‚ Webpack.config.js const TerserPlugin = require('terser-webpack-plugin'); module.exports = { optimization: { minimizer: [ new TerserPlugin({ cache: true, parallel: true, sourceMap: true, // å¦‚æœåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨æºæ˜ å°„ï¼Œåˆ™å¿…é¡»è®¾ç½®ä¸º true terserOptions: { // https://github.com/webpack-contrib/terser-webpack-plugin#terseroptions } }), ], } }; æˆ–è€…ä¼ å…¥å‡½æ•° module.exports = { optimization: { minimizer: [ (compiler) =&gt; { const TerserPlugin = require('terser-webpack-plugin'); new TerserPlugin({ /* your config */ }).apply(compiler); } ], } }; '...'å¯ç”¨äºä¼˜åŒ–. æœ€å°åŒ–å™¨è®¿é—®é»˜è®¤å€¼ã€‚ module.exports = { optimization: { minimizer: [new CssMinimizer(), '...'], } }; optimization.splitChunks object é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebpack v4+ ä¸ºåŠ¨æ€å¯¼å…¥çš„æ¨¡å—æä¾›äº†å¼€ç®±å³ç”¨çš„æ–°çš„å¸¸è§åŒºå—ç­–ç•¥ã€‚è¯·å‚é˜…åœ¨ SplitChunksPlugin é¡µä¸­é…ç½®æ­¤è¡Œä¸ºçš„å¯ç”¨é€‰é¡¹ã€‚ Webpack.config.js module.exports = { //... optimization: { splitChunks: { //è¿™æŒ‡ç¤ºå°†é€‰æ‹©å“ªäº›åŒºå—è¿›è¡Œä¼˜åŒ–ã€‚æä¾›å­—ç¬¦ä¸²æ—¶ï¼Œæœ‰æ•ˆå€¼ä¸ºallã€asyncå’Œinitialã€‚ //æä¾›æ‰€æœ‰å—å¯èƒ½ç‰¹åˆ«å¼ºå¤§ï¼Œå› ä¸ºè¿™æ„å‘³ç€å—å³ä½¿åœ¨å¼‚æ­¥å—å’Œéå¼‚æ­¥å—ä¹‹é—´ä¹Ÿå¯ä»¥å…±äº«ã€‚ chunks: 'async', minSize: 20000,//è¦ç”ŸæˆåŒºå—çš„æœ€å°å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ //æ‹†åˆ†Chunks.minRemainsize é€‰é¡¹åœ¨webpack 5ä¸­å¼•å…¥ï¼Œ //é€šè¿‡ç¡®ä¿æ‹†åˆ†åä¿ç•™çš„åŒºå—çš„æœ€å°å¤§å°è¶…è¿‡é™åˆ¶æ¥é¿å…é›¶å¤§å°çš„æ¨¡å—ã€‚ //åœ¨&quot;å¼€å‘&quot;æ¨¡å¼ä¸‹é»˜è®¤ä¸º 0ã€‚ //å¯¹äºå…¶ä»–æƒ…å†µï¼Œæ‹†åˆ†ä¸º&quot;æ‹†åˆ†&quot;.minRemainsize é»˜è®¤ä¸º splitChunks.minSize çš„å€¼ï¼Œ //å› æ­¤ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šï¼Œä½†éœ€è¦æ·±åº¦æ§åˆ¶çš„æå°‘æ•°æƒ…å†µé™¤å¤– minRemainingSize: 0, //ä½¿ç”¨ maxSizeå‘Šè¯‰ Webpack å°è¯•å°†å¤§äº maxSize å­—èŠ‚çš„åŒºå—æ‹†åˆ†ä¸ºè¾ƒå°çš„éƒ¨åˆ†ã€‚ //é›¶ä»¶çš„å¤§å°è‡³å°‘ä¸ºæœ€å°å°ºå¯¸ï¼ˆæœ€å¤§å°ºå¯¸æ—è¾¹ï¼‰ã€‚ //maxSize é€‰é¡¹ç”¨äº HTTP/2 å’Œé•¿æœŸç¼“å­˜ã€‚å®ƒå¢åŠ äº†è¯·æ±‚è®¡æ•°ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç¼“å­˜ã€‚ //å®ƒè¿˜å¯ç”¨äºå‡å°æ–‡ä»¶å¤§å°ï¼Œä»¥ä¾¿æ›´å¿«åœ°é‡å»ºã€‚ maxSize: 0, minChunks: 1,//æ‹†åˆ†å‰å¿…é¡»å…±äº«æ¨¡å—çš„æœ€å°åŒºå—æ•°ã€‚ maxAsyncRequests: 30,//æŒ‰éœ€åŠ è½½æ—¶å¹¶è¡Œè¯·æ±‚çš„æœ€å¤§æ•°é‡ã€‚ maxInitialRequests: 30,//å…¥å£ç‚¹ä¸Šå¹¶è¡Œè¯·æ±‚çš„æœ€å¤§æ•°ã€‚ //é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebpack å°†ä½¿ç”¨åŒºå—çš„æºå’Œåç§°ï¼ˆä¾‹å¦‚ä¾›åº”å•†main.jsï¼‰ç”Ÿæˆåç§°ã€‚ //æ­¤é€‰é¡¹å…è®¸æ‚¨æŒ‡å®šç”¨äºç”Ÿæˆåç§°çš„åˆ†éš”ç¬¦ã€‚ automaticNameDelimiter: '~', //å¼ºåˆ¶æ‰§è¡Œæ‹†åˆ†çš„å¤§å°é˜ˆå€¼å’Œå…¶ä»–é™åˆ¶ï¼ˆæœ€å°ä¿æŒå¤§å°ã€æœ€å¤§åŒæ­¥è¯·æ±‚ã€æœ€å¤§åˆå§‹è¯·æ±‚ï¼‰å°†è¢«å¿½ç•¥ enforceSizeThreshold: 50000, //ç¼“å­˜ç»„å¯ä»¥ç»§æ‰¿å’Œ/æˆ–è¦†ç›–æ‹†åˆ†Chunksä¸­çš„ä»»ä½•é€‰é¡¹ã€‚ //ä½†æµ‹è¯•ã€ä¼˜å…ˆçº§å’Œé‡ç”¨åªå¯ä»¥åœ¨ç¼“å­˜ç»„çº§åˆ«è¿›è¡Œé…ç½®ã€‚è‹¥è¦ç¦ç”¨ä»»ä½•é»˜è®¤ç¼“å­˜ç»„ï¼Œè¯·å°†å®ƒä»¬è®¾ç½®ä¸º falseã€‚ cacheGroups: { defaultVendors: { test: /[\\\\/]node_modules[\\\\/]/, priority: -10 }, default: { minChunks: 2, //ä¸€ä¸ªæ¨¡å—å¯ä»¥å±äºå¤šä¸ªç¼“å­˜ç»„ã€‚ä¼˜åŒ–å°†æ›´å–œæ¬¢å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„ç¼“å­˜ç»„ã€‚ //é»˜è®¤ç»„å…·æœ‰è´Ÿä¼˜å…ˆçº§ï¼Œå…è®¸è‡ªå®šä¹‰ç»„å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼ˆè‡ªå®šä¹‰ç»„é»˜è®¤å€¼ä¸º 0ï¼‰ã€‚ priority: -20, //å¦‚æœå½“å‰åŒºå—åŒ…å«å·²ç»ä»ä¸»æ†ç»‘åŒ…ä¸­åˆ†ç¦»å‡ºçš„æ¨¡å—ï¼Œåˆ™å°†é‡ç”¨è¯¥åŒºå—ï¼Œ //è€Œä¸æ˜¯ç”Ÿæˆæ–°çš„åŒºå—ã€‚è¿™å¯èƒ½ä¼šå½±å“åŒºå—çš„ç»“æœæ–‡ä»¶åã€‚ reuseExistingChunk: true } } } } }; å¼€å‘ä¸­(devServer) object é€šè¿‡æ¥è‡ª webpack-dev-server çš„è¿™äº›é€‰é¡¹ï¼Œèƒ½å¤Ÿç”¨å¤šç§æ–¹å¼æ”¹å˜å…¶è¡Œä¸ºã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ‰€æœ‰æ¥è‡ª dist/ ç›®å½•çš„æ–‡ä»¶éƒ½åš gzip å‹ç¼©å’Œæä¾›ä¸ºæœåŠ¡ï¼š devServer: { contentBase: path.join(__dirname, &quot;dist&quot;), compress: true, port: 9000 } é€šè¿‡ Node.js API æ¥ä½¿ç”¨ dev-serverï¼Œ devServer ä¸­çš„é€‰é¡¹å°†è¢«å¿½ç•¥ã€‚å°†é€‰é¡¹ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ï¼š new WebpackDevServer(compiler, {...})ã€‚ const Webpack = require('webpack'); const WebpackDevServer = require('../../../lib/Server'); const webpackConfig = require('./webpack.config'); const compiler = Webpack(webpackConfig); const devServerOptions = Object.assign({}, webpackConfig.devServer, { open: true, stats: { colors: true, }, }); const server = new WebpackDevServer(compiler, devServerOptions); server.listen(8080, '127.0.0.1', () =&gt; { console.log('Starting server on http://localhost:8080'); }); devServer.after function æä¾›åœ¨æœåŠ¡å™¨å†…éƒ¨æ‰€æœ‰å…¶ä»–ä¸­é—´ä»¶ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰ä¸­é—´ä»¶çš„èƒ½åŠ›ã€‚ after(app){ // do fancy stuff } devServer.allowedHosts array æ­¤é€‰é¡¹å…è®¸æ‚¨å°†å…è®¸è®¿é—®å¼€å‘æœåŠ¡å™¨çš„æœåŠ¡åˆ—å…¥ç™½åå•ã€‚ allowedHosts: [ 'host.com', 'subdomain.host.com', 'subdomain2.host.com', 'host2.com' ] æ¨¡ä»¿ django çš„ALLOWED_HOSTSï¼Œä¸€ä¸ªä»¥.å¼€å¤´çš„å€¼ã€‚å¯ç”¨ä½œå­åŸŸé€šé…ç¬¦ã€‚.host.comå°†åŒ¹é…host.com www.host.comå’Œä»»ä½•å…¶ä»–å­åŸŸhost.comã€‚ // è¿™è¾¾åˆ°ç›¸åŒçš„æ•ˆæœï¼Œå› ä¸ºç¬¬ä¸€ä¸ªç¤ºä¾‹ // ä¸å¿…æ›´æ–°æ‚¨çš„é…ç½® // å¦‚æœæ–°çš„å­åŸŸéœ€è¦è®¿é—®å¼€å‘æœåŠ¡å™¨ allowedHosts: [ '.host.com', 'host2.com' ] è‹¥è¦åœ¨ CLI ä¸­ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œè¯·ä¼ é€’ --å…è®¸çš„ä¸»æœºé€‰é¡¹é€—å·åˆ†éš”å­—ç¬¦ä¸²ã€‚ webpack-dev-server --entry /entry/file --output-path /output/path --allowed-hosts .host.com,host2.com devServer.before function æä¾›åœ¨æœåŠ¡å™¨å†…éƒ¨æ‰§è¡Œæ‰€æœ‰å…¶ä»–ä¸­é—´ä»¶ä¹‹å‰æ‰§è¡Œè‡ªå®šä¹‰ä¸­é—´ä»¶çš„èƒ½åŠ›ã€‚è¿™å¯ç”¨äºå®šä¹‰è‡ªå®šä¹‰å¤„ç†ç¨‹åºï¼Œä¾‹å¦‚ï¼š before(app){ app.get('/some/path', function(req, res) { res.json({ custom: 'response' }); }); } devServer.bonjour æ­¤é€‰é¡¹åœ¨å¯åŠ¨æ—¶é€šè¿‡ ZeroConf ç½‘ç»œå¹¿æ’­æœåŠ¡å™¨ bonjour: true devServer.clientLogLevel string æ§åˆ¶æ¶ˆæ¯æ˜¾ç¤º å½“ä½¿ç”¨*å†…è”æ¨¡å¼(inline mode)*æ—¶ï¼Œåœ¨å¼€å‘å·¥å…·(DevTools)çš„æ§åˆ¶å°(console)å°†æ˜¾ç¤ºæ¶ˆæ¯ï¼Œå¦‚ï¼šåœ¨é‡æ–°åŠ è½½ä¹‹å‰ï¼Œåœ¨ä¸€ä¸ªé”™è¯¯ä¹‹å‰ï¼Œæˆ–è€…æ¨¡å—çƒ­æ›¿æ¢(Hot Module Replacement)å¯ç”¨æ—¶ã€‚è¿™å¯èƒ½æ˜¾å¾—å¾ˆç¹çã€‚ ä½ å¯ä»¥é˜»æ­¢æ‰€æœ‰è¿™äº›æ¶ˆæ¯æ˜¾ç¤ºï¼Œä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼š clientLogLevel: &quot;none&quot; å¯èƒ½çš„å€¼æœ‰ none, error, warning æˆ–è€… infoï¼ˆé»˜è®¤å€¼ï¼‰ã€‚ devServer.color - Cli only boolean å¯ç”¨/ç¦ç”¨æ§åˆ¶å°ä¸Šçš„é¢œè‰²ã€‚ webpack-dev-server --color devServer.compress boolean å¯ç”¨gzipå‹ç¼© compress:true devServer.contentBase boolean` `string` `array å‘Šè¯‰æœåŠ¡å™¨ä»å“ªé‡Œæä¾›å†…å®¹ã€‚åªæœ‰åœ¨ä½ æƒ³è¦æä¾›é™æ€æ–‡ä»¶æ—¶æ‰éœ€è¦ã€‚devServer.publicPath å°†ç”¨äºç¡®å®šåº”è¯¥ä»å“ªé‡Œæä¾› bundleï¼Œå¹¶ä¸”æ­¤é€‰é¡¹ä¼˜å…ˆã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºæä¾›å†…å®¹çš„ç›®å½•ï¼Œä½†æ˜¯ä½ å¯ä»¥ä¿®æ”¹ä¸ºå…¶ä»–ç›®å½•ï¼š contentBase: path.join(__dirname, &quot;public&quot;) æ³¨æ„ï¼Œæ¨èä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚ ä½†æ˜¯ä¹Ÿå¯ä»¥ä»å¤šä¸ªç›®å½•æä¾›å†…å®¹ï¼š contentBase: [path.join(__dirname, &quot;public&quot;), path.join(__dirname, &quot;assets&quot;)] ç¦ç”¨ contentBaseï¼š contentBase: false devServer.filename string åœ¨æƒ°æ€§æ¨¡å¼ä¸­ï¼Œæ­¤é€‰é¡¹å¯å‡å°‘ç¼–è¯‘ã€‚ é»˜è®¤åœ¨æƒ°æ€§æ¨¡å¼ï¼Œæ¯ä¸ªè¯·æ±‚ç»“æœéƒ½ä¼šäº§ç”Ÿå…¨æ–°çš„ç¼–è¯‘ã€‚ä½¿ç”¨ filenameï¼Œå¯ä»¥åªåœ¨æŸä¸ªæ–‡ä»¶è¢«è¯·æ±‚æ—¶ç¼–è¯‘ã€‚ å¦‚æœ output.filename è®¾ç½®ä¸º bundle.js ï¼Œfilename ä½¿ç”¨å¦‚ä¸‹ï¼š lazy: true, filename: &quot;bundle.js&quot; ç°åœ¨åªæœ‰åœ¨è¯·æ±‚ /bundle.js æ—¶å€™ï¼Œæ‰ä¼šç¼–è¯‘ bundleã€‚ filename åœ¨ä¸ä½¿ç”¨**æƒ°æ€§åŠ è½½***æ—¶æ²¡æœ‰æ•ˆæœã€‚ devServer.headers object åœ¨æ‰€æœ‰å“åº”ä¸­æ·»åŠ é¦–éƒ¨å†…å®¹ï¼š headers: { &quot;X-Custom-Foo&quot;: &quot;bar&quot; } devServer.historyApiFallback boolean object å½“ä½¿ç”¨ HTML5 History API æ—¶ï¼Œä»»æ„çš„ 404 å“åº”éƒ½å¯èƒ½éœ€è¦è¢«æ›¿ä»£ä¸º index.htmlã€‚é€šè¿‡ä¼ å…¥ä»¥ä¸‹å¯ç”¨ï¼š historyApiFallback: true é€šè¿‡ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚ä½¿ç”¨ rewrites è¿™ä¸ªé€‰é¡¹ï¼Œæ­¤è¡Œä¸ºå¯è¿›ä¸€æ­¥åœ°æ§åˆ¶ï¼š historyApiFallback: { rewrites: [ { from: /^\\/$/, to: '/views/landing.html' }, { from: /^\\/subpage/, to: '/views/subpage.html' }, { from: /./, to: '/views/404.html' } ] } å½“è·¯å¾„ä¸­ä½¿ç”¨ç‚¹(dot)ï¼ˆå¸¸è§äº Angularï¼‰ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ disableDotRuleï¼š historyApiFallback: { disableDotRule: true } devServer.host string æŒ‡å®šä½¿ç”¨ä¸€ä¸ª hostã€‚é»˜è®¤æ˜¯ localhostã€‚å¦‚æœä½ å¸Œæœ›æœåŠ¡å™¨å¤–éƒ¨å¯è®¿é—®ï¼ŒæŒ‡å®šå¦‚ä¸‹ï¼š host: &quot;0.0.0.0&quot; devServer.hot boolean å¯ç”¨ webpack çš„æ¨¡å—çƒ­æ›¿æ¢ç‰¹æ€§ï¼š hot:true è¯·æ³¨æ„ï¼ŒWebpackã€‚éœ€è¦çƒ­æ¨¡å—æ›´æ¢æ¨¡å—æ‰èƒ½å®Œå…¨å¯ç”¨ HMRã€‚å¦‚æœä½¿ç”¨ --hot é€‰é¡¹å¯åŠ¨ Webpack æˆ– Webpack-dev-serverï¼Œåˆ™ä¼šè‡ªåŠ¨æ·»åŠ æ­¤æ’ä»¶ï¼Œå› æ­¤æ‚¨å¯èƒ½ä¸éœ€è¦å°†å…¶æ·»åŠ åˆ° Webpack.config.js ä¸­ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… HMR æ¦‚å¿µé¡µé¢ã€‚ devServer.hotOnly boolean å¯ç”¨çƒ­æ¨¡å—æ›¿æ¢ï¼ˆè¯·å‚é˜… devServer.hotï¼‰ï¼Œåœ¨ç”Ÿæˆå¤±è´¥æ—¶ä¸åˆ·æ–°é¡µé¢ä½œä¸ºå›é€€ã€‚ hotOnly: true devServer.https boolean object é»˜è®¤æƒ…å†µä¸‹ï¼Œdev-server é€šè¿‡ HTTP æä¾›æœåŠ¡ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©å¸¦æœ‰ HTTPS çš„ HTTP/2 æä¾›æœåŠ¡ï¼š https:true ä»¥ä¸Šè®¾ç½®ä½¿ç”¨äº†è‡ªç­¾åè¯ä¹¦ï¼Œä½†æ˜¯ä½ å¯ä»¥æä¾›è‡ªå·±çš„ï¼š https: { key: fs.readFileSync(&quot;/path/to/server.key&quot;), cert: fs.readFileSync(&quot;/path/to/server.crt&quot;), ca: fs.readFileSync(&quot;/path/to/ca.pem&quot;), } æ­¤å¯¹è±¡ç›´æ¥ä¼ é€’åˆ° Node.js HTTPS æ¨¡å—ï¼Œæ‰€ä»¥æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ HTTPS æ–‡æ¡£ã€‚ devServer.index string è¢«è§†ä¸ºç´¢å¼•æ–‡ä»¶çš„æ–‡ä»¶åã€‚ index: 'index.htm' devServer.info - CLI only boolean è¾“å‡º cli ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå¤„äºå¯ç”¨çŠ¶æ€ã€‚ webpack-dev-server --info=false devServer.inline boolean åœ¨ dev-server çš„ä¸¤ç§ä¸åŒæ¨¡å¼ä¹‹é—´åˆ‡æ¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºå¯ç”¨å†…è”æ¨¡å¼(inline mode)ã€‚è¿™æ„å‘³ç€ä¸€æ®µå¤„ç†å®æ—¶é‡è½½çš„è„šæœ¬è¢«æ’å…¥åˆ°ä½ çš„åŒ…(bundle)ä¸­ï¼Œå¹¶ä¸”æ„å»ºæ¶ˆæ¯å°†ä¼šå‡ºç°åœ¨æµè§ˆå™¨æ§åˆ¶å°ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ iframe æ¨¡å¼ï¼Œå®ƒåœ¨é€šçŸ¥æ ä¸‹é¢ä½¿ç”¨ `` æ ‡ç­¾ï¼ŒåŒ…å«äº†å…³äºæ„å»ºçš„æ¶ˆæ¯ã€‚åˆ‡æ¢åˆ° iframe æ¨¡å¼ï¼š inline:false æ¨èä½¿ç”¨æ¨¡å—çƒ­æ›¿æ¢çš„å†…è”æ¨¡å¼ï¼Œå› ä¸ºå®ƒåŒ…å«æ¥è‡ª websocket çš„ HMR è§¦å‘å™¨ã€‚è½®è¯¢æ¨¡å¼å¯ä»¥ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¸€ä¸ªé¢å¤–çš„å…¥å£ç‚¹ï¼š'webpack/hot/poll?1000'ã€‚ devServer.lazy boolean å½“å¯ç”¨ lazy æ—¶ï¼Œdev-server åªæœ‰åœ¨è¯·æ±‚æ—¶æ‰ç¼–è¯‘åŒ…(bundle)ã€‚è¿™æ„å‘³ç€ webpack ä¸ä¼šç›‘è§†ä»»ä½•æ–‡ä»¶æ”¹åŠ¨ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæƒ°æ€§æ¨¡å¼â€ã€‚ lazy:true watchOptions åœ¨ä½¿ç”¨æƒ°æ€§æ¨¡å¼æ—¶æ— æ•ˆã€‚ å¦‚æœä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·(CLI)ï¼Œè¯·ç¡®ä¿**å†…è”æ¨¡å¼(inline mode)**è¢«ç¦ç”¨ã€‚ devServer.noInfo boolean å¯ç”¨ noInfo åï¼Œè¯¸å¦‚ã€Œå¯åŠ¨æ—¶å’Œæ¯æ¬¡ä¿å­˜ä¹‹åï¼Œé‚£äº›æ˜¾ç¤ºçš„ webpack åŒ…(bundle)ä¿¡æ¯ã€çš„æ¶ˆæ¯å°†è¢«éšè—ã€‚é”™è¯¯å’Œè­¦å‘Šä»ç„¶ä¼šæ˜¾ç¤ºã€‚ noInfo:true devServer.open boolean å¯ç”¨&quot;open&quot;åï¼Œå¼€å‘æœåŠ¡å™¨å°†æ‰“å¼€æµè§ˆå™¨ã€‚ open: true devServer.openPage string æŒ‡å®šæ‰“å¼€æµè§ˆå™¨æ—¶è¦å¯¼èˆªåˆ°çš„é¡µé¢ã€‚ openPage: '/different/page' devServer.overlay boolean object å½“å­˜åœ¨ç¼–è¯‘å™¨é”™è¯¯æˆ–è­¦å‘Šæ—¶ï¼Œåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºå…¨å±å åŠ ã€‚é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨ã€‚å¦‚æœåªæƒ³æ˜¾ç¤ºç¼–è¯‘å™¨é”™è¯¯ï¼š overlay: true å¦‚æœä½ æƒ³æ—¢æ˜¾ç¤ºé”™è¯¯ä¹Ÿæ˜¾ç¤ºè­¦å‘Š overlay: { warnings: true, errors: true } devServer.port number æŒ‡å®šè¦ç›‘å¬è¯·æ±‚çš„ç«¯å£å·: port:8080 devServer.proxy object ä»£ç†æœåŠ¡å™¨ å¦‚æœä½ æœ‰å•ç‹¬çš„åç«¯å¼€å‘æœåŠ¡å™¨ APIï¼Œå¹¶ä¸”å¸Œæœ›åœ¨åŒåŸŸåä¸‹å‘é€ API è¯·æ±‚ ï¼Œé‚£ä¹ˆä»£ç†æŸäº› URL ä¼šå¾ˆæœ‰ç”¨ã€‚ dev-server ä½¿ç”¨äº†éå¸¸å¼ºå¤§çš„ http-proxy-middleware åŒ…ã€‚æ›´å¤šé«˜çº§ç”¨æ³•ï¼Œè¯·æŸ¥é˜…å…¶æ–‡æ¡£ã€‚ åœ¨ localhost:3000 ä¸Šæœ‰åç«¯æœåŠ¡çš„è¯ï¼Œä½ å¯ä»¥è¿™æ ·å¯ç”¨ä»£ç†ï¼š proxy: { &quot;/api&quot;: &quot;http://localhost:3000&quot; } è¯·æ±‚åˆ° /api/users ç°åœ¨ä¼šè¢«ä»£ç†åˆ°è¯·æ±‚ http://localhost:3000/api/usersã€‚ å¦‚æœä½ ä¸æƒ³å§‹ç»ˆä¼ é€’ /api ï¼Œåˆ™éœ€è¦é‡å†™è·¯å¾„ï¼š proxy: { &quot;/api&quot;: { target: &quot;http://localhost:3000&quot;, pathRewrite: {&quot;^/api&quot; : &quot;&quot;} } } é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸æ¥å—è¿è¡Œåœ¨ HTTPS ä¸Šï¼Œä¸”ä½¿ç”¨äº†æ— æ•ˆè¯ä¹¦çš„åç«¯æœåŠ¡å™¨ã€‚å¦‚æœä½ æƒ³è¦æ¥å—ï¼Œä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š proxy: { &quot;/api&quot;: { target: &quot;https://other-server.example.com&quot;, secure: false } } æœ‰æ—¶ä½ ä¸æƒ³ä»£ç†æ‰€æœ‰çš„è¯·æ±‚ã€‚å¯ä»¥åŸºäºä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ç»•è¿‡ä»£ç†ã€‚ åœ¨å‡½æ•°ä¸­ä½ å¯ä»¥è®¿é—®è¯·æ±‚ä½“ã€å“åº”ä½“å’Œä»£ç†é€‰é¡¹ã€‚å¿…é¡»è¿”å› false æˆ–è·¯å¾„ï¼Œæ¥è·³è¿‡ä»£ç†è¯·æ±‚ã€‚ ä¾‹å¦‚ï¼šå¯¹äºæµè§ˆå™¨è¯·æ±‚ï¼Œä½ æƒ³è¦æä¾›ä¸€ä¸ª HTML é¡µé¢ï¼Œä½†æ˜¯å¯¹äº API è¯·æ±‚åˆ™ä¿æŒä»£ç†ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š proxy: { &quot;/api&quot;: { target: &quot;http://localhost:3000&quot;, bypass: function(req, res, proxyOptions) { if (req.headers.accept.indexOf(&quot;html&quot;) !== -1) { console.log(&quot;Skipping proxy for browser request.&quot;); return &quot;/index.html&quot;; } } } } å¦‚æœè¦å°†å¤šä¸ªç‰¹å®šè·¯å¾„ä»£ç†åˆ°åŒä¸€ç›®æ ‡ï¼Œå¯ä»¥ä½¿ç”¨å…·æœ‰ä¸Šä¸‹æ–‡å±æ€§çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡çš„æ•°ç»„ï¼š proxy: [{ context: [&quot;/auth&quot;, &quot;/api&quot;], target: &quot;http://localhost:3000&quot;, }] devServer.progress - Cli only boolean å°†è¿è¡Œè¿›åº¦è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚ webpack-dev-server --progress devServer.public string å½“ä½¿ç”¨*å†…è”æ¨¡å¼(inline mode)*å¹¶ä»£ç† dev-server æ—¶ï¼Œå†…è”çš„å®¢æˆ·ç«¯è„šæœ¬å¹¶ä¸æ€»æ˜¯çŸ¥é“è¦è¿æ¥åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚å®ƒä¼šå°è¯•æ ¹æ® window.location æ¥çŒœæµ‹æœåŠ¡å™¨çš„ URLï¼Œä½†æ˜¯å¦‚æœå¤±è´¥ï¼Œä½ éœ€è¦è¿™æ ·ã€‚ ä¾‹å¦‚ï¼Œdev-server è¢«ä»£ç†åˆ° nginxï¼Œå¹¶ä¸”åœ¨ myapp.test ä¸Šå¯ç”¨ï¼š public: &quot;myapp.test:80&quot; devServer.publicPath string æ­¤è·¯å¾„ä¸‹çš„æ‰“åŒ…æ–‡ä»¶å¯åœ¨æµè§ˆå™¨ä¸­è®¿é—®ã€‚ å‡è®¾æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:8080 å¹¶ä¸” output.filename è¢«è®¾ç½®ä¸º bundle.jsã€‚é»˜è®¤ publicPath æ˜¯ &quot;/&quot;ï¼Œæ‰€ä»¥ä½ çš„åŒ…(bundle)å¯ä»¥é€šè¿‡ http://localhost:8080/bundle.js è®¿é—®ã€‚ å¯ä»¥ä¿®æ”¹ publicPathï¼Œå°† bundle æ”¾åœ¨ä¸€ä¸ªç›®å½•ï¼š publicPath: &quot;/assets/&quot; ä½ çš„åŒ…ç°åœ¨å¯ä»¥é€šè¿‡ http://localhost:8080/assets/bundle.js è®¿é—®ã€‚ ç¡®ä¿ publicPath æ€»æ˜¯ä»¥æ–œæ (/)å¼€å¤´å’Œç»“å°¾ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå®Œæ•´çš„ URLã€‚è¿™æ˜¯æ¨¡å—çƒ­æ›¿æ¢æ‰€å¿…éœ€çš„ã€‚ publicPath: &quot;http://localhost:8080/assets/&quot; bundle å¯ä»¥é€šè¿‡ http://localhost:8080/assets/bundle.js è®¿é—®ã€‚ devServer.publicPath å’Œ output.publicPath ä¸€æ ·è¢«æ¨èã€‚ devServer.quiet boolean å¯ç”¨ quiet åï¼Œé™¤äº†åˆå§‹å¯åŠ¨ä¿¡æ¯ä¹‹å¤–çš„ä»»ä½•å†…å®¹éƒ½ä¸ä¼šè¢«æ‰“å°åˆ°æ§åˆ¶å°ã€‚è¿™ä¹Ÿæ„å‘³ç€æ¥è‡ª webpack çš„é”™è¯¯æˆ–è­¦å‘Šåœ¨æ§åˆ¶å°ä¸å¯è§ã€‚ quiet:true devServer.socket string è¦ä¾¦å¬çš„ Unix å¥—æ¥å­—ï¼ˆè€Œä¸æ˜¯ä¸»æœºï¼‰ã€‚ socket: 'socket' devServer.staticOptions å¯ä»¥é…ç½®é«˜çº§é€‰é¡¹ï¼Œç”¨äºä»å†…å®¹åº“æä¾›é™æ€æ–‡ä»¶ã€‚æœ‰å…³å¯èƒ½çš„é€‰é¡¹ï¼Œè¯·å‚é˜…å¿«é€Ÿæ–‡æ¡£ã€‚ä¾‹å¦‚ï¼š staticOptions: { redirect: false } devServer.stats æ­¤é€‰é¡¹å…è®¸æ‚¨ç²¾ç¡®æ§åˆ¶æ˜¾ç¤ºçš„æ†ç»‘ä¿¡æ¯ã€‚å¦‚æœæ‚¨æƒ³è¦ä¸€äº›æ†ç»‘ä¿¡æ¯ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„ä¸­é—´åœ°å¸¦ã€‚ stats: &quot;errors-only&quot; ","link":"https://exclison.github.io/post/webpack-pei-zhi-xiang-jie/"},{"title":"Webpackä½¿ç”¨","content":"1.é¡¹ç›®åˆå§‹åŒ– npm init 2.å®‰è£…webpack npm i webpack webpack-dev-server 3.åˆ›å»ºé…ç½®æ–‡ä»¶ //é¡¹ç›®æ–‡æ¡£ç»“æ„ web â”œâ”€package-lock.json â”œâ”€package.json â”œâ”€src | â””main.js â”œâ”€scripts // æ„å»ºè„šæœ¬æ–‡ä»¶å¤¹ | â”œâ”€dev.js //å¼€å‘ç¯å¢ƒæ„å»ºè„šæœ¬ | â”œâ”€prod.js //ç”Ÿäº§ç¯å¢ƒæ„å»ºè„šæœ¬ | â”œâ”€config // æ„å»ºè„šæœ¬é…ç½®æ–‡ä»¶å¤¹ | | â”œâ”€index.js // webpacké…ç½®æ–‡ä»¶ å¯¼å‡ºå¼€å‘ä¸ç”Ÿäº§é…ç½®å‡½æ•° | | â”œâ”€util.js // å¯¼å‡ºå·¥å…·å‡½æ•° | | â”œâ”€plugin // å°è£…æ’ä»¶æ–‡ä»¶å¤¹ | | | â””index.js | | â”œâ”€loader // å°è£…loadersæ–‡ä»¶å¤¹ | | | â””index.js â”œâ”€public | â””index.html // htmlæ¨¡æ¿ â”œâ”€dist // æ‰“åŒ…è¾“å‡ºè·¯å¾„ 4.loaders æ³¨æ„:ç¬¬4,ç¬¬5æ­¥ä¸ºå¸¸ç”¨loaderå’Œpluginä»‹ç» thread-loader //å®‰è£… ä½¿ç”¨æ—¶ï¼Œéœ€å°†æ­¤ loader æ”¾ç½®åœ¨å…¶ä»– loader ä¹‹å‰ã€‚æ”¾ç½®åœ¨æ­¤ loader ä¹‹åçš„ loader ä¼šåœ¨ä¸€ä¸ªç‹¬ç«‹çš„ worker æ± ä¸­è¿è¡Œ npm install --save-dev thread-loader //webpack.config.js module.exports = { module: { rules: [ { test: /\\.js$/, include: path.resolve(&quot;src&quot;), use: [ &quot;thread-loader&quot;, // è€—æ—¶çš„ loader ï¼ˆä¾‹å¦‚ babel-loaderï¼‰ ] } ] } } babel-loader //å½“å‰æ¼”ç¤ºwebpackä½¿ç”¨æ–¹æ³• å…¶ä»–å‚ç…§babelå®˜ç½‘ //å®‰è£… npm install --save-dev babel-loader @babel/core //webpack.config.js module: { rules: [ { test: /\\.js$/, exclude: /node_modules/, loader: &quot;babel-loader&quot; } ] } //åˆ›å»º .babelrc é…ç½®æ–‡ä»¶ //å®‰è£…æ’ä»¶ ä½¿ç”¨è½¬æ¢ ES2015+ çš„ env preset npm install @babel/preset-env --save-dev //.babelrc { &quot;presets&quot;: [&quot;@babel/preset-env&quot;] } eslint-loader //å®‰è£… npm install eslint --save-dev //å®‰è£…eslint npm install eslint-loader --save-dev //å®‰è£…eslint-loader //webpack.config.js module.exports = { module: { rules: [ { test: /\\.js$/, exclude: /node_modules/, use: ['babel-loader', 'eslint-loader'], }, ], }, }; style-loader //å®‰è£… npm install --save-dev style-loader //webpack.config.js module.exports = { module: { rules: [ { test: /\\.css$/i, use: ['style-loader', 'css-loader'], }, ], }, }; css-loader //å®‰è£… npm install --save-dev css-loader //webpack.config.js module.exports = { module: { rules: [ { test: /\\.css$/i, use: ['style-loader', 'css-loader'], }, ], }, }; postcss-loader npm i -D postcss-loader //postcss.config.js module.exports = { parser: 'sugarss', plugins: { 'postcss-import': {}, 'postcss-cssnext': {}, 'cssnano': {} } } //webpack.config.js module.exports = { module: { rules: [ { test: /\\.css$/, use: [ 'style-loader', 'postcss-loader' ] } ] } } less-loader //å®‰è£… npm install --save-dev less-loader less // webpack.config.js module.exports = { ... module: { rules: [{ test: /\\.less$/, use: [{ loader: &quot;style-loader&quot; // creates style nodes from JS strings }, { loader: &quot;css-loader&quot; // translates CSS into CommonJS }, { loader: &quot;less-loader&quot; // compiles Less to CSS }] }] } }; Sass-loader npm install sass-loader node-sass webpack --save-dev // webpack.config.js module.exports = { ... module: { rules: [{ test: /\\.scss$/, use: [{ loader: &quot;style-loader&quot; // å°† JS å­—ç¬¦ä¸²ç”Ÿæˆä¸º style èŠ‚ç‚¹ }, { loader: &quot;css-loader&quot; // \bå°† CSS è½¬åŒ–æˆ CommonJS æ¨¡å— }, { loader: &quot;sass-loader&quot; // å°† Sass ç¼–è¯‘æˆ CSS }] }] } }; Vue-loader //å®‰è£… npm install -D vue-loader vue-template-compiler // webpack.config.js const VueLoaderPlugin = require('vue-loader/lib/plugin') module.exports = { module: { rules: [ // ... å…¶å®ƒè§„åˆ™ { test: /\\.vue$/, loader: 'vue-loader' } ] }, plugins: [ // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶ï¼ new VueLoaderPlugin() ] } Url-loader //å®‰è£… npm install --save-dev url-loader module.exports = { module: { rules: [ { test: /\\.(png|jpg|gif)$/, use: [ { loader: 'url-loader', options: { limit: 8192 } } ] } ] } } File-loader //å®‰è£… npm install --save-dev file-loader module.exports = { module: { rules: [ { test: /\\.(png|jpg|gif)$/, use: [ { loader: 'file-loader', options: {} } ] } ] } } 5.plugins mini-css-extract-plugin //å®‰è£… npm install --save-dev mini-css-extract-plugin //webpack.config.js const MiniCssExtractPlugin = require('mini-css-extract-plugin'); module.exports = { plugins: [new MiniCssExtractPlugin()], module: { rules: [ { test: /\\.css$/i, use: [MiniCssExtractPlugin.loader, 'css-loader'], }, ], }, }; Options html-webpack-plugin //å®‰è£… npm install --save-dev html-webpack-plugin var HtmlWebpackPlugin = require('html-webpack-plugin'); var path = require('path'); var webpackConfig = { entry: 'index.js', output: { path: path.resolve(__dirname, './dist'), filename: 'index_bundle.js' }, plugins: [new HtmlWebpackPlugin()] }; clean-webpack-plugin const { CleanWebpackPlugin } = require('clean-webpack-plugin'); const webpackConfig = { plugins: [ /** * All files inside webpack's output.path directory will be removed once, but the * directory itself will not be. If using webpack 4+'s default configuration, * everything under &lt;PROJECT_DIR&gt;/dist/ will be removed. * Use cleanOnceBeforeBuildPatterns to override this behavior. * * During rebuilds, all webpack assets that are not used anymore * will be removed automatically. * * See `Options and Defaults` for information */ new CleanWebpackPlugin(), ], }; module.exports = webpackConfig; optimize-css-assets-webpack-plugin npm install --save-dev optimize-css-assets-webpack-plugin var OptimizeCssAssetsPlugin = require('optimize-css-assets-webpack-plugin'); module.exports = { module: { rules: [ { test: /\\.css$/, loader: ExtractTextPlugin.extract('style-loader', 'css-loader') } ] }, plugins: [ new ExtractTextPlugin('styles.css'), new OptimizeCssAssetsPlugin({ assetNameRegExp: /\\.optimize\\.css$/g, cssProcessor: require('cssnano'), cssProcessorPluginOptions: { preset: ['default', { discardComments: { removeAll: true } }], }, canPrint: true }) ] }; terser-webpack-plugin npm install terser-webpack-plugin --save-dev const TerserPlugin = require('terser-webpack-plugin'); module.exports = { optimization: { minimize: true, minimizer: [new TerserPlugin()], }, }; HotModuleReplacementPlugin const { HotModuleReplacementPlugin } = require('webpack'); const webpackConfig = { plugins: [ new HotModuleReplacementPlugin(); ], }; module.exports = webpackConfig; 6.ç¯å¢ƒæ„å»º å¼€å‘ç¯å¢ƒ //ä½¿ç”¨nodeAPIæ„å»ºå¼€å‘ç¯å¢ƒ // ./scripts/dev.js const Webpack = require(&quot;webpack&quot;); const WebpackDevServer = require(&quot;webpack-dev-server&quot;); const { getDevConfig } = require(&quot;./config&quot;); const webpackConfig = getDevConfig(); const compiler = Webpack(webpackConfig); const devServerOptions = Object.assign({}, webpackConfig.devServer, { historyApiFallback: true, open: true, hot: true, inline: true, stats: &quot;errors-warnings&quot;, overlay: { // æµè§ˆå™¨å…¨å±æ˜¾ç¤ºé”™è¯¯ errors: true, warnings: false, }, stats: { colors: true, }, }); const server = new WebpackDevServer(compiler, devServerOptions); server.listen(8087, &quot;127.0.0.1&quot;, () =&gt; { console.log(&quot;Starting server on http://localhost:8087&quot;); }); ç”Ÿäº§ç¯å¢ƒ //ä½¿ç”¨nodeAPIæ„å»ºç”Ÿäº§ç¯å¢ƒ // ./scripts/prod.js const { getProdConfig } = require(&quot;./config&quot;); const config = getProdConfig(); const webpack = require(&quot;webpack&quot;); const compiler = webpack(config); compiler.run((err, stats) =&gt; { const info = stats.toJson(); if (err) { console.error(err.stack || err); if (err.details) { console.error(err.details); } return; }else if (stats.hasErrors()) { console.error(info.errors); }else if (stats.hasWarnings()) { console.warn(info.warnings); }else{ console.log('build successfully') console.log([ console.log(`Time: ${info.time}ms`), console.log(`output: ${info.outputPath}`), console.log(`webpack version: ${info.version}`), ].join('\\n')) } }); 7.è¡¥å……ä»£ç  å°†webpacké…ç½®æ–‡ä»¶ä»¥å‡½æ•°å½¢å¼å°è£… // ./scripts/config/index.js const { getJSLoader, getVueLoader, getCSSLoader, getLESSLoader, getSASSLoader, getAssetsLoader, } = require(&quot;./loader&quot;); const { getVueLoaderPlugin, getHtmlWebpackPlugin, getStylePlugin, getMiniCssExtractPlugin, getTerserPlugin, getHotModuleReplacementPlugin, } = require(&quot;./plugin&quot;); const { reslove } = require(&quot;./util&quot;); function getCommonConfig () { return { entry: reslove(&quot;./src/main.js&quot;), // å…¥å£æ–‡ä»¶ resolve: { // è§£ææ¨¡å—è¯·æ±‚çš„é€‰é¡¹ // ï¼ˆä¸é€‚ç”¨äºå¯¹ loader è§£æï¼‰ extensions: [&quot;.js&quot;, &quot;.json&quot;, &quot;.jsx&quot;, &quot;.css&quot;], // ä½¿ç”¨çš„æ‰©å±•å alias: { // æ¨¡å—åˆ«ååˆ—è¡¨ &quot;@&quot;: reslove(&quot;./src&quot;), }, }, }; } exports.getDevConfig = function () { const mode = &quot;development&quot;; const common = getCommonConfig(); return Object.assign(common, { output: { path: reslove(&quot;./dist&quot;), //æ‰“åŒ…åçš„æ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹ filename: &quot;[name].[hash].js&quot;, //æ‰“åŒ…åè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å }, mode, module: { // å…³äºæ¨¡å—é…ç½® rules: [ // æ¨¡å—è§„åˆ™ï¼ˆé…ç½® loaderã€è§£æå™¨ç­‰é€‰é¡¹ï¼‰ getJSLoader(mode), getVueLoader(mode), getCSSLoader(mode), getLESSLoader(mode), getSASSLoader(mode), ...getAssetsLoader(mode), ], }, plugins: [ getVueLoaderPlugin(), getHtmlWebpackPlugin({ template:reslove('./public/index.html'), filename:'index.html', minify: { caseSensitive: false, // æ˜¯å¦å¤§å°å†™æ•æ„Ÿ collapseWhitespace: true, // æ˜¯å¦å»é™¤ç©ºæ ¼ removeAttributeQuotes: true, // å»æ‰å±æ€§å¼•ç”¨ removeComments: true, // å»æ³¨é‡Š }, }), getHotModuleReplacementPlugin(), ], }); } exports.getProdConfig = function () { const mode = &quot;production&quot;; const common = getCommonConfig(); return Object.assign(common, { output: { path: reslove(&quot;./dist&quot;), //æ‰“åŒ…åçš„æ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹ filename: &quot;[name].[chunkhash].js&quot;, //æ‰“åŒ…åè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å }, mode, module: { // å…³äºæ¨¡å—é…ç½® rules: [ // æ¨¡å—è§„åˆ™ï¼ˆé…ç½® loaderã€è§£æå™¨ç­‰é€‰é¡¹ï¼‰ getJSLoader(mode), getVueLoader(mode), getCSSLoader(mode), getLESSLoader(mode), getSASSLoader(mode), ...getAssetsLoader(mode), ], }, plugins: [ getVueLoaderPlugin(), getHtmlWebpackPlugin({ template:reslove('./public/index.html'), filename:'index.html', minify: { caseSensitive: false, // æ˜¯å¦å¤§å°å†™æ•æ„Ÿ collapseWhitespace: true, // æ˜¯å¦å»é™¤ç©ºæ ¼ removeAttributeQuotes: true, // å»æ‰å±æ€§å¼•ç”¨ removeComments: true, // å»æ³¨é‡Š }, }), getMiniCssExtractPlugin(), getStylePlugin(), ], optimization: { minimize: true, minimizer: [new getTerserPlugin()], }, }); } å°è£…å¸¸ç”¨loaders // ./scripts/config/loader/index.js const MiniCssExtractPlugin = require(&quot;mini-css-extract-plugin&quot;); const eslintLoader = { loader: &quot;eslint-loader&quot;, options: { fix: true, }, }; exports.getJSLoader = function (mode) { const use = [ &quot;thread-loader&quot;, { loader: &quot;babel-loader&quot;, options: { presets: [&quot;@babel/preset-env&quot;], }, }, ]; mode === &quot;development&quot; &amp;&amp; use.push(eslintLoader); return { test: /\\.js$/, use, exclude: /node_modules/, }; } exports.getVueLoader = function (mode) { const use = [&quot;vue-loader&quot;]; mode === &quot;development&quot; &amp;&amp; use.push(eslintLoader); return { test: /\\.vue$/, use, }; } exports.getCSSLoader = function (mode) { const use = [ mode === &quot;development&quot; ? &quot;style-loader&quot; : MiniCssExtractPlugin.loader, &quot;css-loader&quot;, &quot;postcss-loader&quot;, ]; return { test: /\\.css$/i, use, }; } exports.getLESSLoader = function (mode) { const use = [ mode === &quot;development&quot; ? &quot;style-loader&quot; : MiniCssExtractPlugin.loader, &quot;css-loader&quot;, &quot;postcss-loader&quot;, &quot;less-loader&quot;, ]; return { test: /\\.less$/i, use, }; } exports.getSASSLoader = function (mode) { const use = [ mode === &quot;development&quot; ? &quot;style-loader&quot; : MiniCssExtractPlugin.loader, &quot;css-loader&quot;, &quot;postcss-loader&quot;, &quot;sass-loader&quot;, ]; return { test: /\\.less$/i, use, }; } exports.getAssetsLoader = function (mode) { const name = mode === &quot;development&quot; ? &quot;[name].[ext]&quot; : &quot;[name].[contenthash].[ext]&quot; const imgReslove = { test: /\\.(png|jpg|jpeg|svg|gif)$/, use: [ { loader: &quot;url-loader&quot;, options: { name: `assets/images/${name}`, limit: 3 * 1024, }, }, ], } const mediaReslove = { test: /\\.(mp4|avi|mp3|rmvb|wmv|flv|webm)$/, use: [ { loader: &quot;file-loader&quot;, options: { name: `assets/media/${name}`, }, }, ], } const fontReslove = { test: /\\.(woff2|woff|eot|ttf|otf)$/, use: [ { loader: &quot;url-loader&quot;, options: { name: `assets/font/${name}`, }, }, ], } return [imgReslove,mediaReslove,fontReslove]; } å°è£…å¸¸ç”¨plugins // ./scripts/config/plugins/index.js const VueLoaderPlugin = require(&quot;vue-loader/lib/plugin&quot;); const HtmlWebpackPlugin = require(&quot;html-webpack-plugin&quot;); const { CleanWebpackPlugin } = require(&quot;clean-webpack-plugin&quot;); const OptimizeCssAssetsPlugin = require(&quot;optimize-css-assets-webpack-plugin&quot;); const MiniCssExtractPlugin = require(&quot;mini-css-extract-plugin&quot;); const { HotModuleReplacementPlugin } = require('webpack'); const TerserPlugin = require('terser-webpack-plugin'); exports.getVueLoaderPlugin = function () { return new VueLoaderPlugin(); } exports.getHtmlWebpackPlugin = function (options) { return new HtmlWebpackPlugin(Object.assign({}, options)); } exports.getCleanWebpackPlugin = function (options) { return new CleanWebpackPlugin(Object.assign({}, options)); } exports.getStylePlugin = function (options) { return new OptimizeCssAssetsPlugin( Object.assign( { assetNameRegExp: /\\.optimize\\.css$/g, cssProcessor: require(&quot;cssnano&quot;), cssProcessorPluginOptions: { preset: [&quot;default&quot;, { discardComments: { removeAll: true } }], }, canPrint: true, }, options ) ); } exports.getMiniCssExtractPlugin = function (options) { return new MiniCssExtractPlugin(Object.assign({ filename: 'assets/style/[name].[contenthash].css', }, options)); } exports.getHotModuleReplacementPlugin = function () { return new HotModuleReplacementPlugin(); } exports.getTerserPlugin = function (options) { return new TerserPlugin( Object.assign({ cache: true, // ä½¿ç”¨ cacheï¼ŒåŠ å¿«äºŒæ¬¡æ„å»ºé€Ÿåº¦ parallel: true, // å¼€å¯å¤šçº¿ç¨‹ extractComments: true, terserOptions: { compress: { unused: true, drop_debugger: true, drop_console: true, dead_code: true, }, }, },options) ); } å·¥å…·å‡½æ•° // ./scripts/config/util.js const path = require('path') exports.reslove = function (url){ return path.resolve(__dirname,`../../${url}`) } ","link":"https://exclison.github.io/post/webpack-shi-yong/"},{"title":"es6æ‰©å±•è¿ç®—ç¬¦","content":"è®°ä¸€æ¬¡es6æ‰©å±•è¿ç®—ç¬¦æŠ¥é”™çš„è§£å†³åŠæ³• å¯¹è±¡å±•å¼€è¿ç®—ç¬¦æŠ¥é”™æ—¶éœ€è¦å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼š npm install --save-dev babel-plugin-transform-object-rest-spread åœ¨.babelrcæ–‡ä»¶ä¸­é…ç½®ï¼š {&quot;plugins&quot;:[&quot;transform-object-rest-spread&quot;]} ","link":"https://exclison.github.io/post/es6-kuo-zhan-yun-suan-fu/"},{"title":"Hello Gridea","content":"ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ Windowsï¼ŒMacOS æˆ– Linux è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ ","link":"https://exclison.github.io/post/hello-gridea/"}]}